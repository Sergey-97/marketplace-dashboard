# Marketplace Dashboard

Analytics dashboard –¥–ª—è –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤ OZON –∏ Wildberries —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π API, —Å–±–æ—Ä–æ–º –¥–∞–Ω–Ω—ã—Ö –≤ Supabase –∏ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ–º –Ω–∞ Render + Vercel.

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
marketplace-dashboard/
‚îú‚îÄ‚îÄ backend/                    # Node.js/Express API
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.js           # –ì–ª–∞–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config/            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (Supabase, Redis)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/       # API –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/            # API –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/          # –°–µ—Ä–≤–∏—Å—ã (OZON, WB)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ jobs/              # –û—á–µ—Ä–µ–¥–∏ –∏ –≤–æ—Ä–∫–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îî‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ frontend/                   # Vercel-hosted UI
‚îÇ   ‚îî‚îÄ‚îÄ index.html
‚îú‚îÄ‚îÄ .github/workflows/          # CI/CD
‚îî‚îÄ‚îÄ .gitignore
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –õ–æ–∫–∞–ª—å–Ω–æ

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**
   ```bash
   git clone https://github.com/Sergey-97/marketplace-dashboard.git
   cd marketplace-dashboard
   ```

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
   ```bash
   cd backend
   cp .env.example .env
   # –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env –∏ –¥–æ–±–∞–≤—å—Ç–µ:
   # - SUPABASE_URL, SUPABASE_SERVICE_KEY
   # - OZON_API_KEY, WB_API_KEY
   # - REDIS_URL (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
   ```

3. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å**
   ```bash
   npm install
   npm run dev
   ```

4. **Frontend**
   ```bash
   cd ../frontend
   # –û—Ç–∫—Ä–æ–π—Ç–µ index.html –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ—Å—Ç–æ–π HTTP —Å–µ—Ä–≤–µ—Ä:
   npx serve .
   ```

5. **–ó–∞–ø—É—Å—Ç–∏—Ç—å worker (–µ—Å–ª–∏ –µ—Å—Ç—å Redis)**
   ```bash
   npm run worker
   ```

## üìä API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### Health & Root
- `GET /` ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–∏—Å–µ
- `GET /health` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–µ—Ä–∞

### –î–∞–Ω–Ω—ã–µ
- `GET /api/products` ‚Äî —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
- `GET /api/sales?startDate=...&endDate=...&marketplace=all` ‚Äî –ø—Ä–æ–¥–∞–∂–∏
- `GET /api/orders?startDate=...&endDate=...` ‚Äî –∑–∞–∫–∞–∑—ã —Å –¥–µ—Ç–∞–ª—è–º–∏
- `GET /api/order-expenses?startDate=...&endDate=...` ‚Äî —Ä–∞—Å—Ö–æ–¥—ã –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- `POST /api/sync/trigger` ‚Äî –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
- `GET /api/sync/status/:jobId` ‚Äî —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `backend/.env.example` –≤ `backend/.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

```env
PORT=10000
NODE_ENV=development

# Supabase
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_KEY=your-key

# Redis (–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è production worker)
REDIS_URL=redis://:password@host:6379

# CORS
CORS_ORIGINS=http://localhost:3000,https://your-frontend.vercel.app
FRONTEND_URL=https://your-frontend.vercel.app

# APIs
OZON_API_KEY=your-key
WB_API_KEY=your-key
```

## üö¢ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Render (Backend)

1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –í—ã–±—Ä–∞—Ç—å –≤–µ—Ç–∫—É `main`
3. Build command: `npm ci`
4. Start command: `npm run start`
5. –î–æ–±–∞–≤–∏—Ç—å Environment Variables (—Å–º. –≤—ã—à–µ)
6. –°–æ–∑–¥–∞—Ç—å Background Worker —Å –∫–æ–º–∞–Ω–¥–æ–π: `npm run worker`

### Vercel (Frontend)

1. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –∏–∑ GitHub
2. –í—ã–±—Ä–∞—Ç—å –ø–∞–ø–∫—É: `frontend`
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è: `NEXT_PUBLIC_API_URL` (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Next.js)
4. –î–ª—è –æ–±—ã—á–Ω–æ–≥–æ HTML —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å API_BASE –≤ meta-—Ç–µ–≥–µ `index.html`

## üìà –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ª–æ–≥–∏–∫–∞

### –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö (OZON/WB API)

1. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é** (cron) ‚Äî –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 03:00 UTC
2. **–ù–∞-–∑–∞–ø—Ä–æ—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** (POST /sync/trigger) ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç –∑–∞–¥–∞—á—É –≤ –æ—á–µ—Ä–µ–¥—å
3. **Background Worker** (Node.js) ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ (2 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ)
4. **–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–≥—Ä—É–∑–∫–∏, –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
5. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –≤—Å–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `sync_logs`

### –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö (Supabase PostgreSQL)

- `products` ‚Äî —Ç–æ–≤–∞—Ä—ã —Å –æ—Å—Ç–∞—Ç–∫–∞–º–∏, —Ü–µ–Ω–∞–º–∏
- `sales_fact` ‚Äî –∑–∞–∫–∞–∑—ã, –ø—Ä–æ–¥–∞–∂–∏, –≤–æ–∑–≤—Ä–∞—Ç—ã
- `sync_logs` ‚Äî –ª–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- `orders_extended` ‚Äî –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤ (—Ä–∞—Å—Ö–æ–¥—ã, –ø—Ä–∏–±—ã–ª—å)

### –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (Redis)

- –û—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á (BullMQ)
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –∫–µ—à —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
cd backend
npm run test:ozon
npm run test:wb
```

## üìù TODO / –£–ª—É—á—à–µ–Ω–∏—è

- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å OZON API (orders, prices, returns)
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å WB API
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é (—Ö—Ä–∞–Ω–∏—Ç—å lastSyncDate)
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Å–±–æ—Ä –æ—Ç–∑—ã–≤–æ–≤ –∏ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
- [ ] –í–Ω–µ–¥—Ä–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏ (Prometheus/Sentry)
- [ ] –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö (CSV, XLSX)
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≤–µ–±—Ö—É–∫–∏ –æ—Ç –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤

## üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏

- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –¥–ª—è Vercel/Render
- ‚úÖ Health endpoint –¥–æ–±–∞–≤–ª–µ–Ω
- ‚úÖ Background worker –¥–ª—è –æ—á–µ—Ä–µ–¥–µ–π
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω—ã–π frontend —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ CI/CD pipeline (GitHub Actions)
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –ø—Ä–∏–º–µ—Ä—ã

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [Supabase Schema](./docs/schema.md) ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- [API Reference](./docs/api.md) ‚Äî –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- [Deployment Guide](./docs/deployment.md) ‚Äî –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –¥–µ–ø–ª–æ—é

## ü§ù –ö–æ–Ω—Ç—Ä–∏–±—å—é—Ç–∏–Ω–≥

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞—Ç—å feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏–π (`git commit -m 'Add some AmazingFeature'`)
4. Push –≤ –≤–µ—Ç–∫—É (`git push origin feature/AmazingFeature`)
5. –û—Ç–∫—Ä—ã—Ç—å Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

ISC

## üë§ –ê–≤—Ç–æ—Ä

Sergey-97

## üìß –ö–æ–Ω—Ç–∞–∫—Ç—ã

GitHub: [@Sergey-97](https://github.com/Sergey-97)
